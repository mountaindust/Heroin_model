---
title: "ABM Network Analysis"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
---

```{r, echo = FALSE}
library(tidyverse)
library(knitr)
library(kableExtra)

#setwd("Desktop/opioid_research/Heroin_model/ABM/data_analysis") # Set to wd

source(file = "individual_functions/ic.R")
source(file = "individual_functions/plot_SPAHR.R")

abm_data = "data/SPAHR_data/smaller_num_analysis/SPAHR_ABM_SU2020_06-01_debug heroin_run-table.csv"
ode_data = "data/SPAHR_data/smaller_num_analysis/ODE_comparison4.csv"

options(scipen = 999) # Disables scientific notation in R

icdf_overall = generate_ic(abm_data, option = "overall")
icdf_s = generate_ic(abm_data, option = "S")
icdf_p = generate_ic(abm_data, option = "P")
icdf_a = generate_ic(abm_data, option = "A")
icdf_h = generate_ic(abm_data, option = "H")
icdf_r = generate_ic(abm_data, option = "R")
```

Basic Stats {.sidebar}
=====================================

### Basic Statistics

```{r, echo = FALSE, results = 'asis'}
kable(icdf_overall) %>% kable_styling() # Overall statistics displayed on Sidebar
```

S
=====================================

```{r splot, fig.height=5.5, fig.align="center"}
#plotS(abm = abm_data, ode = ode_data)
plotSPAHR(abm = abm_data, ode = ode_data, plot_class = "S")
# Display the plot
```

### S Values

```{r svals, echo = FALSE, results = 'asis', fig.height = 2}
#icdf_s %>% kable() %>% kable_styling()
#kable(icdf_s, align = 'c')
kable(icdf_s) %>% kable_styling()
# Display initial values below the plot
```

P
=====================================

```{r pplot, fig.height = 5.5, fig.align="center"}
#plotP(abm = abm_data, ode = ode_data)
plotSPAHR(abm = abm_data, ode = ode_data, plot_class = "P")
```

### P Values

```{r pvals, echo = FALSE, results = 'asis', fig.height = 2}
#kable(icdf_p)
kable(icdf_p) %>% kable_styling()
```

A
=====================================

```{r aplot, fig.height = 5.5, fig.align="center"}
#plotA(abm = abm_data, ode = ode_data)
plotSPAHR(abm = abm_data, ode = ode_data, plot_class = "A")
```

### A Values

```{r avals, echo = FALSE, results = 'asis', fig.height = 2}
kable(icdf_a) %>% kable_styling()
```

H
=====================================

```{r hplot, fig.height = 5.5, fig.align="center"}
#plotH(abm = abm_data, ode = ode_data)
plotSPAHR(abm = abm_data, ode = ode_data, plot_class = "H")

```

### H Values
```{r hvals, echo = FALSE, results = 'asis', fig.height = 2}
kable(icdf_h) %>% kable_styling()
```

R
=====================================

```{r rplot, fig.height = 5.5, fig.align="center"}
#plotR(abm = abm_data, ode = ode_data)
plotSPAHR(abm = abm_data, ode = ode_data, plot_class = "R")
```

### R Values

```{r rvals, echo = FALSE, results = 'asis', fig.height = 2}
kable(icdf_r) %>% kable_styling()
```

